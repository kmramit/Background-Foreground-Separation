\documentclass[12pt,a4paper]{report}
\usepackage[pdftex]{graphicx} 
\usepackage{url} 

\begin{document}
\renewcommand\bibname{References} 

\begin{titlepage}

\begin{center}

\textup{\small {\bf CS771 Project} \\ Report}\\[0.2in]

\Large \textbf {Separation of foreground frame from background with  high
accuracy in real time}\\[0.5in]
{Department of Computer Science \& Engineering, \\IIT Kanpur }\\[0.2in]

\normalsize Submitted by \\
\begin{table}[h]
\centering
\begin{tabular}{lr} 
Gaurav & 13274 \\
Amit Kumar& 13094 \\
R Sundararajan& 13523\\ \\ 
\end{tabular}
\end{table}

\vspace{.1in}
Under the guidance of\\
{\textbf{Prof. Harish Karnick}}\\[0.2in]

\end{center}
\end{titlepage}
\begin{abstract}
Project is being submitted as the CS771 course project under guidance of Prof Harish Karnick. 
The purpose is to classify the frames as background or foreground with close to perfection.
In this report, we provide the results of the various algorithms we tried to achieve better accuracy.
We first tried standard OpenCV MOG library that resulted in about 92\% accuracy after suitably processing the input frames. Then we shifted to Vibe algorithm which lead to rapid increase in accuracy to about 98\%. Then we implemented the CodeBook Algorithm proposed by Kyungnam Kim and applied certain parameters tweeks to increase accuracy level to 98.37\%.
Observaing the problems in Coodbook we tried to apply edge detection operator on Coodbook results to further enhance the accuracy. Even though the accuracy level improved but the average frame rate fell dramaticaly that lead us to discard the improvement. 
\end{abstract} 
% \section{Motivation}
\section*{Algorithms Tried:}
\subsection*{MOG (Mixture Of Gaussians)}
MOG characterise each pixel by its intensity in the RGB space.The probability of observing a pixel is modelled using a mixture of Gaussian distributions.For each new incoming pixel, the Mahalanobis distance to the distibution is calculated and depending on the threshold, the incoming pixel is classified as background or foreground.In practice, the unmodified output of MOG gives pretty noisy results whereas after blurring the output frame followed by erosion and dilation to we get better contours. 
\subsubsection{Difficulties}
\begin{itemize}
\item {\bf Foreground Aperture problem:}With backgrounds having fast variations, it becomes difficult to model properly modelled using a few Gaussians.To counter this, if the model is approximated by a large number of Gaussians then slow moving foreground pixels are absorbed into the background resulting in a high false negative rate. 
\item {\bf Shadow problem:}Shadows due to objects outside the frame lead to mis-classification of frames as foreground. And if we tend to remove the shadow Mog tend to remove the entire object on which the shadow falls leading to some foreground frame being classified as back-ground.
\end{itemize} 
\subsection*{ViBe}
Vibe is a standard background subtraction algorithm that extracts background features and information from moving frames.
For each pixel values in the past at  its location are stored to maintain adn develop  history model.Now when we need to classify a pixel, we create a sphere of radius R centered a the location. A pixel is classified as background if the number of samples enclosed in the sphere corresponding to its model are greater than a threshold value.Finally, when the pixel is found to be part of the background, its value is propagated into the background model of a neighboring pixel. 
\begin{itemize}
\item {\bf Stop targets:}If a moving target stops in the field of view for a long time it sends the the target into background thereby misclassifying the frame.
\item {\bf Broken targets:} Splitting the entire target into several pieces because of some parts of target very similar to the background.This leads to quite low bounding box-accuracy  
\end{itemize} 

\subsection*{CodeBook Algorithm}
CodeBook algorithm works in two phases, namely learning phase and update phase.Sample background values at each pixel are quantized into codebooks which represent a compressed form of background model much like the bag-of-words representation in text sequences.This helps in capturing background variation due to periodic like motion over a long spam of time with limited memory being used.One of the advantages over other algorithm is that it does not need to be trained on strictly empty frames.Can somewhat handle illumination variations and moving backgrounds but this is better handled using Layered Model Detection.
\begin{itemize}
\item {\bf Poor Frame Rate:}CodeBook has quite poor frame rate of 8-9 frames/sec as compared to MOG 20 frames/sec and Vibe
33 frames/sec. 
\item {\bf Broken targets:} For example. a man's head and a man's body were sometimes detected in separate contours which caused breaking of the bounding boxes. But the splitting was low as compared to Vibe.
\end{itemize} 

\section*{CodeBook And its improvement}
\subsection*{Layered Model Detection(Cache based detection)}
While testing, a cache model (as mentioned in the paper by Kim et al.) is maintained in addition to the original background model generated during training. This helps in detecting foreground objects against new
backgrounds which were obtained during the detection phase.For this we define an additional cache model and for each incoming pixel at detection time we try to matching codeword in original training model, if fails then we try in this cache model and if even not in cache we add it in the cache model. Then we filter the codewords in cache and keep the ones that stay for a long time. 
\begin{itemize}
\item Another way to handle the problem of noisy bounding boxes due to movement of shadows. 
\item Results in movement of small stationary foreground pixels into the background thereby drastically reducing the noise.
\end{itemize}

\subsection*{Combining codebook's result with an edge detection operator}
The result of the codebook algorithm is combined with an edge detection algorithm (we used Sobel operator).
The main idea is to highlight the boundaries of objects in a scene.This usage of an edge detector will verify if foreground pixels detected by the codebook algorithm belongs to an object or not.The increase in box-bounding accuracy was quite noticeable but we had to discard this improvement as the overhead of slower frame rate was much high as compared to the improvement achieved. 
\begin{itemize}
\item We observed an improvement of (~ 5-7 \%) over the basic codebook algorithm.
\item We obtained an interesting result when working on convex hulls of the contours instead of directly drawing the bounding rectangle of a contour.
\end{itemize}

\end{document}
